{% extends "layout.html" %}
{% block title %}Blog & Galerie – Vianu Biologists{% endblock %}

{% block content %}
<section class="blog-wrap">
  <aside class="blog-dna">
    <svg viewBox="0 0 60 500" class="dna-slim" aria-label="ADN decorativ lateral">
      <!-- helix -->
      <path d="M20,10 C5,80 55,120 40,180 C25,240 35,300 20,360 C10,420 15,470 20,490"
            fill="none" stroke="#2e7d32" stroke-width="4"/>
      <path d="M40,10 C55,80 5,120 20,180 C35,240 25,300 40,360 C50,420 45,470 40,490"
            fill="none" stroke="#1565c0" stroke-width="4"/>
      <!-- benzi color pentru secțiuni -->
      <rect x="10" y="70"  width="40" height="26" rx="4" fill="#43a047"/>
      <rect x="10" y="230" width="40" height="26" rx="4" fill="#1976d2"/>
      <rect x="10" y="390" width="40" height="26" rx="4" fill="#e53935"/>
    </svg>

    <!-- butoane filtrare (opțional, dacă le ai deja, păstrează-le acolo) -->
    <nav class="blog-dna-nav">
      <a href="{{ url_for('blog') }}#insta" class="pill pill-blue">INSTA</a>
      <a href="{{ url_for('blog') }}#articles" class="pill pill-red">ARTICOLE</a>
      <a href="{{ url_for('blog') }}#galerie" class="pill pill-blue">GALERIE</a>
      <a href="{{ url_for('index') }}" class="pill pill-red">HOME</a>
    </nav>
  </aside>

  <div class="blog-content">
    {# aici rămâne căutarea + lista de postări #}
    {{ super() if false }}
    <!-- pune conținutul tău existent: search, posts loop etc. -->
  </div>
</section>


  <!-- CONȚINUT PRINCIPAL -->
  <div class="blog-main">
    <h2>---------------------------POSTARI!-----------------------</h2>

    <!-- CĂUTARE TITLU -->
    <div class="search-bar">
      <input type="text" id="searchInput" onkeyup="searchPosts()" placeholder="Caută după titlu...">
    </div>

    <!-- POSTĂRI DIN DB -->
    {% for p in posts %}
      <div class="post-item"
           data-section="{{ p.section }}"
           data-title="{{ (p.title or '')|lower }}">
        <h3>
          {% if p.section == 'insta' %}Insta:{% elif p.section == 'gallery' %}Galerie:{% else %}Articol:{% endif %}
          {{ p.title }}
        </h3>

        <small>
          <strong>Autor:</strong> {{ p.author or 'Club BIO' }}
          | <strong>Data:</strong> {{ p.created_at.strftime('%Y-%m-%d') if p.created_at else '' }}
          | <strong>Secțiune:</strong>
          {% if p.section == 'insta' %}Insta{% elif p.section == 'gallery' %}Galerie{% else %}Articol{% endif %}
        </small>

        {% if p.image_url %}
          <img src="{{ p.image_url }}" class="gallery-img" alt="cover">
        {% endif %}

        {% if p.content %}
          <p>{{ p.content }}</p>
        {% endif %}

        {% if p.external_url %}
          <p><a href="{{ p.external_url }}" target="_blank" rel="noopener">Vezi link</a></p>
        {% endif %}
      </div>
    {% else %}
      <p>Nu există postări încă. Adaugă din <a href="{{ url_for('admin_new') }}">admin</a>.</p>
    {% endfor %}
  </div>
</section>

<style>
.blog-wrapper { display:flex; gap:30px; margin-top:30px; }
.blog-sidebar { width:180px; display:flex; flex-direction:column; gap:15px; padding-left:10px; }
.nav-btn { padding:15px; font-weight:700; border:none; color:#fff; cursor:pointer; transform:skew(-15deg); font-size:16px; transition:background .2s ease; }
.nav-btn:hover { opacity:.9; }
.nav-btn.insta { background:#1da1f2; }
.nav-btn.article { background:#e63946; }
.nav-btn.gallery { background:#1da1f2; }
.nav-btn.home { background:#e63946; }
.nav-deco { height:40px; background:#ccc; transform:skew(-15deg); opacity:.2; }
.blog-main { flex:1; }
.search-bar { margin-bottom:20px; }
#searchInput { width:100%; padding:10px; font-size:16px; border-radius:6px; border:1px solid #ccc; }
.post-item { background:#fff; border-left:5px solid #28a745; margin-bottom:20px; padding:15px; border-radius:6px; }
.post-item small { display:block; margin-bottom:10px; font-size:13px; color:#666; }
.gallery-img { max-width:100%; border-radius:6px; margin-top:10px; }
</style>

<script>
function filterContent(section) {
  const allPosts = document.querySelectorAll('.post-item');
  allPosts.forEach(post => {
    const postSection = post.getAttribute('data-section');
    post.style.display = (section === 'all' || postSection === section) ? 'block' : 'none';
  });
}
function searchPosts() {
  const input = (document.getElementById("searchInput").value || "").toLowerCase();
  const posts = document.querySelectorAll(".post-item");
  posts.forEach(post => {
    const title = (post.getAttribute("data-title") || "").toLowerCase();
    post.style.display = title.includes(input) ? "block" : "none";
  });
}
</script>
{% endblock %}
